<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRP SKETCH | Official</title>
    <style>
        :root { --amz-orange: #febd69; --amz-dark: #232f3e; --bg: #131921; --card: #ffffff; --text: #111; }
        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); color: #fff; padding-bottom: 80px; }
        
        /* Strict Login Gate */
        #login-gate { position: fixed; inset: 0; background: #fff; color: #111; z-index: 9999; display: flex; flex-direction: column; align-items: center; padding: 40px 20px; }
        .gate-box { width: 100%; max-width: 350px; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }

        /* UI Structure */
        #main-app { display: none; }
        .section { display: none; padding: 15px; animation: fadeIn 0.3s ease; }
        .active-section { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        header { background: #232f3e; padding: 15px; display: flex; justify-content: space-between; position: sticky; top:0; z-index: 1000; color: var(--amz-orange); font-weight: bold; font-size: 20px; }
        
        /* Grid & Cards */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .product-card { background: var(--card); color: var(--text); padding: 10px; border-radius: 4px; display: flex; flex-direction: column; position: relative; }
        .product-card img { width: 100%; height: 160px; object-fit: cover; border-radius: 2px; }
        .out-of-stock { opacity: 0.4; filter: grayscale(1); }
        .stock-badge { position: absolute; top: 10px; left: 10px; background: red; color: white; padding: 2px 6px; font-size: 10px; font-weight: bold; border-radius: 3px; }

        /* Buttons & Inputs */
        .btn { width: 100%; padding: 12px; border-radius: 20px; border: none; font-weight: bold; cursor: pointer; margin-top: 8px; }
        .btn-orange { background: #ffa41c; border: 1px solid #ff8f00; }
        .btn-yellow { background: #ffd814; border: 1px solid #fcd200; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #a6a6a6; border-radius: 3px; box-sizing: border-box; }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #232f3e; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #3a4553; }
        .nav-item { text-align: center; font-size: 11px; color: #ccc; cursor: pointer; }
        .nav-item.active { color: var(--amz-orange); font-weight: bold; }

        /* Admin Controls */
        .admin-card { background: #fff; color: #111; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .manage-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; align-items: center; }

        /* Overlays */
        .overlay { position: fixed; inset: 0; background: #fff; color: #111; z-index: 5000; padding: 20px; display: none; overflow-y: auto; }
    </style>
</head>
<body>

<div id="login-gate">
    <div class="gate-box">
        <center><h1>SRP SKETCH</h1></center>
        <h2>Sign-In</h2>
        <input type="email" id="gate-email" placeholder="Email Address">
        <input type="password" id="gate-pass" placeholder="Password">
        <button class="btn btn-orange" onclick="unlockSite()">Continue</button>
        <p style="font-size:12px; color: #666; text-align: center; margin-top: 15px;">You must sign in to view sketches and prices.</p>
    </div>
</div>

<div id="main-app">
    <header>SRP SKETCH</header>

    <div id="home-sec" class="section active-section">
        <div class="grid" id="product-display"></div>
    </div>

    <div id="rishi-sec" class="section">
        <h3>ü§ñ AI Rishi Assistant</h3>
        <div id="chat-box" style="height: 300px; background: #000; padding: 15px; border-radius: 8px; overflow-y: auto; margin-bottom: 10px;">
            <p style="color: var(--amz-orange);"><b>Rishi:</b> Hello! I am your 24/7 shopping assistant. I can help you with prices, stock info, and payment details. How can I help?</p>
        </div>
        <div style="display:flex; gap:5px;">
            <input type="text" id="rishi-input" placeholder="Ask Rishi..." style="margin:0;">
            <button class="btn btn-orange" style="width:80px; margin:0;" onclick="talkToRishi()">Ask</button>
        </div>
    </div>

    <div id="wallet-sec" class="section">
        <h3>My Wallet</h3>
        <div style="background:#232f3e; padding:40px; border-radius:12px; text-align:center;">
            <h1 style="font-size: 40px; margin:0;">‚Çπ0.00</h1>
            <p>Available Balance</p>
            <button class="btn btn-yellow" style="width:auto; padding:10px 40px;">Add Money</button>
        </div>
    </div>

    <div id="you-sec" class="section">
        <h3>My Account</h3>
        <div class="admin-card" style="padding:0;">
            <div style="padding:15px; border-bottom:1px solid #eee;" onclick="showMyOrders()">üì¶ My Orders</div>
            <div style="padding:15px; border-bottom:1px solid #eee;">üõ°Ô∏è Privacy Policy</div>
            <div style="padding:15px; border-bottom:1px solid #eee;">üìú User Agreement</div>
            <div style="padding:15px; color:red;" onclick="logout()">üö™ Sign Out</div>
        </div>
    </div>

    <div id="admin-sec" class="section">
        <h3>Admin Dashboard</h3>
        
        <div class="admin-card">
            <h4>Upload New Sketch</h4>
            <input type="text" id="new-title" placeholder="Sketch Title">
            <input type="number" id="new-price" placeholder="Price (‚Çπ)">
            <input type="file" id="new-file" accept="image/*">
            <button class="btn btn-orange" onclick="handleUpload()">Publish Sketch</button>
        </div>

        <div class="admin-card">
            <h4>Manage Existing Sketches</h4>
            <div id="manage-list"></div>
        </div>

        <div class="admin-card">
            <h4>Order Logs</h4>
            <div id="admin-orders"></div>
        </div>

        <div class="admin-card">
            <h4>Security</h4>
            <input type="text" id="new-admin-pass" placeholder="Change Admin Password">
            <button class="btn btn-yellow" onclick="changeAdminPass()">Update Password</button>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="navTo('home')">üè†<br>Home</div>
        <div class="nav-item" onclick="navTo('rishi')">ü§ñ<br>Rishi</div>
        <div class="nav-item" onclick="navTo('wallet')">üí≥<br>Wallet</div>
        <div class="nav-item" onclick="youNav()">üë§<br>You</div>
        <div class="nav-item" onclick="adminNav()">‚öôÔ∏è<br>Admin</div>
    </nav>
</div>

<div id="pay-overlay" class="overlay">
    <h2>Secure Checkout</h2>
    <div id="checkout-summary" style="font-weight:bold; margin-bottom:15px;"></div>
    
    <input type="text" id="cust-name" placeholder="Full Name">
    <input type="text" id="cust-whatsapp" placeholder="WhatsApp Number">
    <textarea id="cust-addr" placeholder="Full Address with Pincode"></textarea>
    
    <p style="color:green; font-weight:bold;">Payment: UPI QR Code (Required)</p>
    <div id="qr-display" style="text-align:center; padding:10px;"></div>
    
    <button class="btn btn-orange" onclick="confirmUPIOrder()">I have Paid via UPI</button>
    <button class="btn" onclick="closeOverlay()" style="background:#eee;">Cancel</button>
</div>

<script>
    // --- APP DATA ---
    const UPI_ID = "subhashrajpurohit406@okaxis";
    let adminPass = localStorage.getItem('srp_admin_pwd') || "SRP786";
    let products = JSON.parse(localStorage.getItem('srp_items')) || [];
    let orders = JSON.parse(localStorage.getItem('srp_orders')) || [];
    let activeItem = null;

    // --- SITE UNLOCKING ---
    function unlockSite() {
        const email = document.getElementById('gate-email').value;
        const pass = document.getElementById('gate-pass').value;
        if(email.includes('@') && pass.length > 3) {
            document.getElementById('login-gate').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
            renderStore();
        } else {
            alert("Enter valid credentials to browse.");
        }
    }

    function logout() { location.reload(); }

    // --- NAVIGATION ---
    function navTo(secId) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active-section'));
        document.getElementById(secId + '-sec').classList.add('active-section');
        
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    function adminNav() {
        if(prompt("Enter Admin Password:") === adminPass) {
            navTo('admin');
            renderManageList();
            renderAdminOrders();
        } else { alert("Access Denied."); }
    }

    function youNav() { navTo('you'); }

    // --- ADMIN ACTIONS ---
    function handleUpload() {
        const file = document.getElementById('new-file').files[0];
        const title = document.getElementById('new-title').value;
        const price = document.getElementById('new-price').value;

        if(!file || !title || !price) return alert("Fill all fields");

        const reader = new FileReader();
        reader.onloadend = () => {
            products.push({ id: Date.now(), title, price, img: reader.result, inStock: true });
            localStorage.setItem('srp_items', JSON.stringify(products));
            alert("Published!");
            renderStore();
            renderManageList();
        };
        reader.readAsDataURL(file);
    }

    function renderManageList() {
        const list = document.getElementById('manage-list');
        list.innerHTML = products.map((p, i) => `
            <div class="manage-item">
                <span>${p.title} (‚Çπ${p.price})</span>
                <div>
                    <button onclick="toggleStock(${i})">${p.inStock ? '‚úÖ In Stock' : '‚ùå Out'}</button>
                    <button onclick="deleteItem(${i})" style="color:red">Delete</button>
                </div>
            </div>
        `).join('');
    }

    function toggleStock(i) { products[i].inStock = !products[i].inStock; updateDB(); }
    function deleteItem(i) { if(confirm("Delete?")) { products.splice(i, 1); updateDB(); } }
    function updateDB() { 
        localStorage.setItem('srp_items', JSON.stringify(products)); 
        renderStore(); renderManageList(); 
    }

    function changeAdminPass() {
        let p = document.getElementById('new-admin-pass').value;
        if(p) { adminPass = p; localStorage.setItem('srp_admin_pwd', p); alert("Password Updated!"); }
    }

    // --- STORE LOGIC ---
    function renderStore() {
        const grid = document.getElementById('product-display');
        grid.innerHTML = products.map((p, i) => `
            <div class="product-card ${p.inStock ? '' : 'out-of-stock'}">
                ${p.inStock ? '' : '<div class="stock-badge">OUT OF STOCK</div>'}
                <img src="${p.img}">
                <div style="font-weight:bold; margin-top:5px;">${p.title}</div>
                <div style="color:#B12704; font-weight:bold;">‚Çπ${p.price}</div>
                <button class="btn btn-orange" ${p.inStock ? '' : 'disabled'} onclick="initCheckout(${i})">Buy Now</button>
            </div>
        `).join('');
    }

    function initCheckout(i) {
        activeItem = products[i];
        document.getElementById('checkout-summary').innerText = `Purchase: ${activeItem.title} - ‚Çπ${activeItem.price}`;
        const qr = `https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=upi://pay?pa=${UPI_ID}&am=${activeItem.price}&cu=INR`;
        document.getElementById('qr-display').innerHTML = `<img src="${qr}"><br><small>Scan to Pay ‚Çπ${activeItem.price}</small>`;
        document.getElementById('pay-overlay').style.display = 'block';
    }

    function confirmUPIOrder() {
        const name = document.getElementById('cust-name').value;
        if(!name) return alert("Please enter your name");
        
        orders.push({
            item: activeItem.title,
            price: activeItem.price,
            name: name,
            phone: document.getElementById('cust-whatsapp').value,
            addr: document.getElementById('cust-addr').value,
            date: new Date().toLocaleString()
        });
        localStorage.setItem('srp_orders', JSON.stringify(orders));
        alert("Order Received! We will verify payment and contact you.");
        closeOverlay();
    }

    function closeOverlay() { document.getElementById('pay-overlay').style.display = 'none'; }

    // --- RISHI AI ---
    function talkToRishi() {
        const q = document.getElementById('rishi-input').value.toLowerCase();
        const chat = document.getElementById('chat-box');
        chat.innerHTML += `<p style="color:white; text-align:right;"><b>You:</b> ${q}</p>`;
        
        let ans = "I am Rishi. You can ask me about stock or how to buy sketches via UPI.";
        if(q.includes("price")) ans = "All prices are listed under the sketches in the Home section.";
        if(q.includes("payment")) ans = "We only accept UPI payments. A QR code appears when you click 'Buy Now'.";
        if(q.includes("stock")) ans = "If an item says 'Out of Stock', it cannot be ordered right now.";
        
        setTimeout(() => {
            chat.innerHTML += `<p style="color:var(--amz-orange);"><b>Rishi:</b> ${ans}</p>`;
            chat.scrollTop = chat.scrollHeight;
        }, 500);
        document.getElementById('rishi-input').value = "";
    }

    function renderAdminOrders() {
        document.getElementById('admin-orders').innerHTML = orders.map(o => `
            <div style="border-bottom:1px solid #eee; padding:10px; font-size:12px;">
                <b>${o.item} (‚Çπ${o.price})</b><br>By: ${o.name} (${o.phone})<br>Addr: ${o.addr}
            </div>
        `).reverse().join('');
    }
</script>
</body>
</html>
