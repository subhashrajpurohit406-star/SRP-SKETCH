<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRP SKETCH | Pro</title>
    <style>
        :root { --amz-orange: #febd69; --amz-dark: #232f3e; --bg: #131921; --card: #ffffff; --text: #111; }
        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); color: #fff; padding-bottom: 80px; overflow-x: hidden; }
        
        /* Persistent Login Gate */
        #auth-gate { position: fixed; inset: 0; background: #fff; color: #111; z-index: 10000; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .auth-container { width: 100%; max-width: 380px; border: 1px solid #ddd; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* Layout Structure */
        #app-shell { display: none; }
        .view { display: none; padding: 15px; animation: slideUp 0.3s ease-out; }
        .active-view { display: block; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        header { background: #232f3e; padding: 15px; position: sticky; top:0; z-index: 1000; color: var(--amz-orange); font-size: 22px; font-weight: bold; border-bottom: 2px solid #37475a; }
        
        /* Grid & Cards */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .item-card { background: var(--card); color: var(--text); padding: 12px; border-radius: 6px; display: flex; flex-direction: column; transition: 0.2s; }
        .item-card img { width: 100%; height: 170px; object-fit: cover; border-radius: 4px; }
        
        /* UI Elements */
        .btn { width: 100%; padding: 12px; border-radius: 25px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 14px; }
        .btn-p { background: #ffa41c; border: 1px solid #ff8f00; }
        .btn-s { background: #ffd814; border: 1px solid #fcd200; }
        input, textarea { width: 100%; padding: 14px; margin: 10px 0; border: 1px solid #a6a6a6; border-radius: 4px; box-sizing: border-box; }

        /* Navigation */
        .nav { position: fixed; bottom: 0; width: 100%; background: #232f3e; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #3a4553; }
        .nav-link { text-align: center; font-size: 11px; color: #a2a2a2; cursor: pointer; text-decoration: none; }
        .nav-link.active { color: var(--amz-orange); font-weight: bold; }

        /* Chat */
        #rishi-chat { height: 350px; background: #1a1a1a; padding: 15px; border-radius: 8px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .r-msg { align-self: flex-start; background: #37475a; padding: 10px; border-radius: 10px; color: #fff; max-width: 80%; font-size: 14px; }
        .u-msg { align-self: flex-end; background: var(--amz-orange); padding: 10px; border-radius: 10px; color: #000; max-width: 80%; font-size: 14px; }

        /* Settings List */
        .list-box { background: #fff; color: #111; border-radius: 8px; margin-top: 10px; }
        .list-item { padding: 18px; border-bottom: 1px solid #eee; display: flex; align-items: center; cursor: pointer; font-weight: 500; }
        .list-item:last-child { border: none; }
    </style>
</head>
<body>

<div id="auth-gate">
    <div class="auth-container">
        <center><h1 style="color:#232f3e; margin:0;">SRP SKETCH</h1></center>
        <h2 style="margin: 20px 0 10px;">Sign-In</h2>
        <input type="email" id="auth-email" placeholder="Email Address">
        <input type="password" id="auth-pass" placeholder="Password">
        <button class="btn btn-p" onclick="secureLogin()">Continue</button>
        <p style="font-size:12px; color: #666; text-align: center; margin-top: 15px;">We use secure verification to protect your sketches.</p>
    </div>
</div>

<div id="app-shell">
    <header>SRP SKETCH</header>

    <div id="home-view" class="view active-view">
        <div class="grid" id="main-store"></div>
    </div>

    <div id="rishi-view" class="view">
        <h3>ü§ñ Rishi Assistant</h3>
        <div id="rishi-chat">
            <div class="r-msg">Welcome back! I can help you manage your orders or explain our sketch pricing. Ask me anything!</div>
        </div>
        <div style="display:flex; gap:8px; margin-top:10px;">
            <input type="text" id="r-input" placeholder="Ask Rishi..." style="margin:0;">
            <button class="btn btn-p" style="width:70px; margin:0;" onclick="chatWithRishi()">Ask</button>
        </div>
    </div>

    <div id="wallet-view" class="view">
        <h3>My Wallet</h3>
        <div style="background:linear-gradient(135deg, #232f3e, #37475a); padding:40px; border-radius:15px; text-align:center; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
            <h1 style="font-size: 45px; margin:0;">‚Çπ0.00</h1>
            <p style="color: #ccc;">Current Balance</p>
            <button class="btn btn-s" style="width:auto; padding:12px 50px;">Add Money</button>
        </div>
    </div>

    <div id="you-view" class="view">
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:20px;">
            <div style="width:50px; height:50px; background:#febd69; border-radius:50%; display:flex; justify-content:center; align-items:center; color:#000; font-weight:bold; font-size:20px;" id="u-initial">U</div>
            <div id="u-name-display" style="font-weight:bold;">User</div>
        </div>
        
        <div class="list-box">
            <div class="list-item" onclick="openFullPage('orders')">üì¶ My Orders</div>
            <div class="list-item" onclick="openFullPage('manage-acc')">üë• Manage Account (Switch)</div>
            <div class="list-item" onclick="openFullPage('about')">‚ÑπÔ∏è About Us & Links</div>
            <div class="list-item" onclick="openFullPage('privacy')">üõ°Ô∏è Privacy Policy</div>
            <div class="list-item" onclick="openFullPage('agreement')">üìú User Agreement</div>
            <div class="list-item" onclick="logout()" style="color: #d9534f;">üö™ Sign Out</div>
        </div>
    </div>

    <div id="admin-view" class="view">
        <h3>Admin Dashboard</h3>
        <div style="background:#fff; color:#111; padding:15px; border-radius:10px;">
            <button class="btn btn-p" onclick="showAdm('upload')">Upload New</button>
            <button class="btn btn-p" onclick="showAdm('manage')">Manage Sketches</button>
            <button class="btn btn-p" onclick="showAdm('orders')">Order History</button>
            <button class="btn btn-p" onclick="showAdm('config')">Edit About/Links</button>
            <button class="btn btn-s" onclick="showAdm('pwd')">Security</button>
            
            <hr style="margin:20px 0;">

            <div id="adm-upload">
                <input type="text" id="p-title" placeholder="Title">
                <input type="number" id="p-price" placeholder="Price">
                <input type="file" id="p-file" accept="image/*">
                <button class="btn btn-p" onclick="adminPublish()">Publish</button>
            </div>

            <div id="adm-manage" style="display:none;">
                <div id="edit-list"></div>
            </div>

            <div id="adm-orders" style="display:none;">
                <div id="admin-order-logs"></div>
            </div>

            <div id="adm-pwd" style="display:none;">
                <input type="text" id="new-adm-pwd" placeholder="New Password">
                <button class="btn btn-p" onclick="updateAdmPwd()">Update</button>
            </div>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-link active" onclick="switchTab('home')">üè†<br>Home</div>
        <div class="nav-link" onclick="switchTab('rishi')">ü§ñ<br>Rishi</div>
        <div class="nav-link" onclick="switchTab('wallet')">üí≥<br>Wallet</div>
        <div class="nav-link" onclick="switchTab('you')">üë§<br>You</div>
        <div class="nav-link" onclick="adminAuth()">‚öôÔ∏è<br>Admin</div>
    </nav>
</div>

<div id="page-overlay" class="auth-gate" style="display:none; background:#fff; color:#111; position:fixed; inset:0; z-index:11000; padding:20px; overflow-y:auto;">
    <h2 id="page-title">Title</h2>
    <div id="page-content">Content</div>
    <button class="btn btn-p" onclick="closePage()">Close</button>
</div>

<script>
    // --- DATABASE MOCK ---
    let products = JSON.parse(localStorage.getItem('srp_items')) || [];
    let orders = JSON.parse(localStorage.getItem('srp_orders')) || [];
    let adminPass = localStorage.getItem('srp_adm_p') || "SRP786";
    let currentUser = JSON.parse(localStorage.getItem('srp_session'));

    // --- INITIALIZATION & SESSION PERSISTENCE ---
    window.onload = function() {
        if(currentUser) {
            document.getElementById('auth-gate').style.display = 'none';
            document.getElementById('app-shell').style.display = 'block';
            document.getElementById('u-name-display').innerText = currentUser.email;
            document.getElementById('u-initial').innerText = currentUser.email[0].toUpperCase();
            renderStore();
        }
    };

    function secureLogin() {
        const email = document.getElementById('auth-email').value;
        const pass = document.getElementById('auth-pass').value;
        
        // Simulating Google Verification (Must be real email format and pass > 5)
        if(email.includes('@') && email.includes('.') && pass.length > 5) {
            const user = { email: email, timestamp: Date.now() };
            localStorage.setItem('srp_session', JSON.stringify(user));
            location.reload();
        } else {
            alert("Security Error: Invalid Google Credentials. Please check your email and password.");
        }
    }

    function logout() {
        localStorage.removeItem('srp_session');
        location.reload();
    }

    // --- NAVIGATION ---
    function switchTab(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
        document.getElementById(id + '-view').classList.add('active-view');
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    function adminAuth() {
        if(prompt("Admin Access Code:") === adminPass) switchTab('admin');
    }

    // --- ADMIN LOGIC ---
    function showAdm(id) {
        ['upload','manage','orders','pwd'].forEach(k => document.getElementById('adm-'+k).style.display='none');
        document.getElementById('adm-'+id).style.display='block';
        if(id === 'manage') renderManage();
        if(id === 'orders') renderAdminOrders();
    }

    function adminPublish() {
        const file = document.getElementById('p-file').files[0];
        const reader = new FileReader();
        reader.onloadend = () => {
            products.push({ id: Date.now(), title: document.getElementById('p-title').value, price: document.getElementById('p-price').value, img: reader.result, status: 'available' });
            localStorage.setItem('srp_items', JSON.stringify(products));
            alert("Sketch Live!"); renderStore();
        };
        if(file) reader.readAsDataURL(file);
    }

    function renderManage() {
        const box = document.getElementById('edit-list');
        box.innerHTML = products.map((p, i) => `
            <div style="padding:10px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center;">
                <span style="color:#111">${p.title} (${p.status})</span>
                <div>
                    <button onclick="updateStatus(${i})">Stock</button>
                    <button onclick="delItem(${i})" style="color:red">Delete</button>
                </div>
            </div>
        `).join('');
    }

    function updateStatus(i) {
        products[i].status = products[i].status === 'available' ? 'out of stock' : 'available';
        saveDB(); renderManage(); renderStore();
    }
    function delItem(i) { if(confirm("Delete?")) { products.splice(i,1); saveDB(); renderManage(); renderStore(); } }
    function saveDB() { localStorage.setItem('srp_items', JSON.stringify(products)); }

    // --- STORE ---
    function renderStore() {
        const grid = document.getElementById('main-store');
        grid.innerHTML = products.map((p, i) => `
            <div class="item-card ${p.status !== 'available' ? 'oos' : ''}">
                <img src="${p.img}">
                <div style="margin-top:8px; font-weight:bold;">${p.title}</div>
                <div style="color:red; font-weight:bold;">‚Çπ${p.price}</div>
                <button class="btn btn-p" ${p.status !== 'available' ? 'disabled' : ''} onclick="alert('Proceeding to UPI Payment...')">Buy Now</button>
            </div>
        `).join('');
    }

    // --- PAGES & LINKS ---
    function openFullPage(type) {
        const overlay = document.getElementById('page-overlay');
        const title = document.getElementById('page-title');
        const content = document.getElementById('page-content');
        overlay.style.display = 'block';

        if(type === 'orders') {
            title.innerText = "My Orders";
            content.innerHTML = "No orders found for " + currentUser.email;
        } else if(type === 'about') {
            title.innerText = "About SRP Studio";
            content.innerHTML = "Owner: Subhash Rajpurohit<br>Visit our YouTube: SRP STUDIO<br>Links: <a href='#'>Portfolio</a>";
        } else if(type === 'manage-acc') {
            title.innerText = "Manage Accounts";
            content.innerHTML = "Active: " + currentUser.email + "<br><button class='btn btn-s' onclick='logout()'>Add Another Account</button>";
        } else {
            title.innerText = type.toUpperCase();
            content.innerText = "Privacy Policy and Terms for SRP SKETCH users.";
        }
    }

    function closePage() { document.getElementById('page-overlay').style.display='none'; }

    // --- RISHI AI (Advanced Responses) ---
    function chatWithRishi() {
        const input = document.getElementById('r-input');
        const chat = document.getElementById('rishi-chat');
        if(!input.value) return;

        chat.innerHTML += `<div class="u-msg">${input.value}</div>`;
        const q = input.value.toLowerCase();
        let ans = "I am Rishi. Ask me about sketches, prices, or how to order.";
        
        if(q.includes("price")) ans = "Sketches range from ‚Çπ500 to ‚Çπ5000 based on detail.";
        if(q.includes("how to buy")) ans = "Simply click 'Buy Now' on any sketch to open the UPI payment gateway.";
        if(q.includes("about")) ans = "This site belongs to SRP STUDIO. We specialize in handmade charcoal sketches.";
        
        setTimeout(() => {
            chat.innerHTML += `<div class="r-msg"><b>Rishi:</b> ${ans}</div>`;
            chat.scrollTop = chat.scrollHeight;
        }, 500);
        input.value = "";
    }
</script>
</body>
</html>
