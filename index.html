<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SRP SHOPPING | Online Shopping India</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        :root { 
            --amz-navy: #232f3e; 
            --amz-light-navy: #37475a;
            --amz-orange: #febd69; 
            --amz-yellow: #ffd814;
            --bg: #e3e6e6; 
        }

        body { margin: 0; font-family: 'Amazon Ember', Arial, sans-serif; background: var(--bg); color: #111; overflow-x: hidden; }
        
        /* AUTHENTICATION GATE (AMAZON STYLE) */
        #auth-gate { position: fixed; inset: 0; background: #fff; z-index: 9999; display: flex; flex-direction: column; align-items: center; padding-top: 20px; }
        .auth-logo { font-size: 28px; font-weight: 800; color: #000; margin-bottom: 20px; letter-spacing: -1px; }
        .auth-logo span { color: var(--amz-orange); }
        .auth-box { width: 90%; max-width: 350px; border: 1px solid #ddd; padding: 25px; border-radius: 8px; }
        .auth-box h2 { margin: 0 0 15px; font-weight: 400; font-size: 28px; }
        .auth-box label { font-size: 13px; font-weight: 700; display: block; margin-bottom: 5px; }
        input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #a6a6a6; border-radius: 3px; box-sizing: border-box; outline-color: #e77600; }
        .btn-amz { background: linear-gradient(to bottom, #f7dfa5, #f0c14b); border: 1px solid #a88734; border-radius: 3px; padding: 10px; width: 100%; cursor: pointer; font-size: 13px; }
        .new-to-amz { width: 90%; max-width: 350px; text-align: center; margin-top: 20px; position: relative; }
        .new-to-amz:before { content: ""; position: absolute; top: 50%; left: 0; right: 0; border-top: 1px solid #e7e7e7; z-index: 1; }
        .new-to-amz span { background: #fff; padding: 0 10px; position: relative; z-index: 2; color: #767676; font-size: 12px; }
        .btn-google { background: #fff; border: 1px solid #adb1b8; border-radius: 3px; padding: 10px; width: 100%; margin-top: 15px; display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer; }

        /* PRO HEADER */
        header { background: var(--amz-navy); padding-bottom: 5px; position: sticky; top: 0; z-index: 1000; }
        .nav-top { display: flex; align-items: center; padding: 10px 15px; gap: 15px; }
        .logo { color: #fff; font-size: 18px; font-weight: bold; text-decoration: none; }
        .logo span { color: var(--amz-orange); }
        .search-container { background: #fff; border-radius: 5px; display: flex; margin: 0 10px 10px; overflow: hidden; height: 45px; }
        .search-container input { border: none; flex: 1; margin: 0; padding: 0 15px; font-size: 15px; }
        .search-btn { background: var(--amz-orange); border: none; width: 50px; cursor: pointer; font-size: 20px; }

        /* HERO AREA */
        .hero { height: 200px; background: linear-gradient(to bottom, rgba(0,0,0,0), var(--bg)), url('https://m.media-amazon.com/images/I/61N833Wkz9L._SX3000_.jpg'); background-size: cover; margin-bottom: -50px; }

        /* CATEGORIES */
        .cats { display: flex; overflow-x: auto; padding: 10px; gap: 15px; background: #fff; scrollbar-width: none; }
        .cat-item { min-width: 70px; text-align: center; font-size: 11px; font-weight: bold; }
        .cat-item img { width: 50px; height: 50px; border-radius: 50%; background: #f5f5f5; object-fit: contain; }

        /* PRODUCT GRID */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; margin-top: 10px; }
        .card { background: #fff; border-radius: 4px; padding: 10px; display: flex; flex-direction: column; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .card img { width: 100%; height: 160px; object-fit: contain; }
        .card-info { margin-top: 10px; }
        .card-title { font-size: 14px; color: #111; height: 35px; overflow: hidden; margin-bottom: 5px; }
        .card-price { font-size: 20px; font-weight: bold; }
        .card-mrp { font-size: 12px; text-decoration: line-through; color: #565959; }

        /* BOTTOM NAV */
        nav { position: fixed; bottom: 0; width: 100%; background: #fff; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ddd; z-index: 5000; }
        .nav-link { text-align: center; color: #111; text-decoration: none; font-size: 11px; flex: 1; }
        .nav-link svg { width: 22px; height: 22px; margin-bottom: 2px; }
        
        /* ADMIN & WALLET PAGES */
        .section { display: none; padding: 15px; padding-bottom: 100px; }
        .active-sec { display: block !important; }
        .wallet-card { background: var(--amz-light-navy); color: #fff; padding: 25px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
    </style>
</head>
<body>

<div id="auth-gate">
    <div class="auth-logo">srp-shopping<span>.in</span></div>
    <div class="auth-box">
        <h2>Sign-In</h2>
        <label>Email (phone for mobile accounts)</label>
        <input type="email" id="u-email" placeholder="example@gmail.com">
        <label>Password</label>
        <input type="password" id="u-pass" placeholder="At least 6 characters">
        <button class="btn-amz" onclick="handleLogin()">Continue</button>
        <p style="font-size: 12px; margin-top: 15px;">By signing in, you agree to SRP SHOPPING's Conditions of Use.</p>
    </div>
    <div class="new-to-amz">
        <span>New to SRP Shopping?</span>
        <button class="btn-google" onclick="loginWithGoogle()">
            <img src="https://www.gstatic.com/images/branding/product/1x/gsa_512dp.png" width="18"> Continue with Google
        </button>
    </div>
</div>

<div id="main-app" style="display:none;">
    <header>
        <div class="nav-top">
            <div class="logo">srp-shopping<span>.in</span></div>
            <div id="user-display" style="color:white; font-size:12px; margin-left:auto;">Hello, User</div>
        </div>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search SRP Shopping" onkeyup="filterItems()">
            <button class="search-btn">üîç</button>
        </div>
    </header>

    <main id="home-sec" class="section active-sec">
        <div class="hero"></div>
        <div class="cats">
            <div class="cat-item"><img src="https://m.media-amazon.com/images/I/41-l8Wq3VXL.jpg">Mobile</div>
            <div class="cat-item"><img src="https://m.media-amazon.com/images/I/71Xm06F6SLL.jpg">Fashion</div>
            <div class="cat-item"><img src="https://m.media-amazon.com/images/I/81vYv-hA9OL.jpg">Home</div>
            <div class="cat-item"><img src="https://m.media-amazon.com/images/I/41-l8Wq3VXL.jpg">Kitchen</div>
            <div class="cat-item"><img src="https://m.media-amazon.com/images/I/51H-iP8qY8L.jpg">Beauty</div>
        </div>
        <div class="grid" id="p-grid"></div>
    </main>

    <section id="wallet-sec" class="section">
        <div class="wallet-card">
            <p>Amazon Pay Balance</p>
            <h1 id="balance-txt">‚Çπ0.00</h1>
        </div>
        <input type="number" id="add-amt" placeholder="Add Balance (‚Çπ)">
        <button class="btn-amz" onclick="addMoney()">Add via UPI</button>
    </section>

    <section id="admin-sec" class="section">
        <div style="background:#fff; padding:15px; border-radius:5px;">
            <h3>Admin Dashboard</h3>
            <input type="text" id="p-name" placeholder="Product Name">
            <input type="number" id="p-mrp" placeholder="MRP">
            <input type="number" id="p-price" placeholder="Sale Price">
            <input type="file" id="p-file" accept="image/*">
            <button class="btn-amz" id="up-btn" onclick="publishItem()">Add Product to Live Store</button>
            <hr>
            <div id="orders-list" style="color:#000;"></div>
        </div>
    </section>

    <nav>
        <div class="nav-link" onclick="showSec('home')">üè†<br>Home</div>
        <div class="nav-link" onclick="showSec('wallet')">üí≥<br>Pay</div>
        <div class="nav-link" onclick="toggleAdmin()">‚öôÔ∏è<br>Admin</div>
        <div class="nav-link" onclick="logout()">üë§<br>Logout</div>
    </nav>
</div>

<script>
    // --- FIREBASE CONFIG ---
    const firebaseConfig = {
        apiKey: "AIzaSyChyu_nVnU-ewwXkpYOPqhwn6WPV7J6UM",
        authDomain: "srp-sketch.firebaseapp.com",
        databaseURL: "https://srp-sketch-default-rtdb.firebaseio.com", 
        projectId: "srp-sketch",
        storageBucket: "srp-sketch.firebasestorage.app",
        messagingSenderId: "1094431391415",
        appId: "1:1094431391415:web:6ef0bcd2841373e20fd732"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    // --- AUTH LOGIC ---
    function loginWithGoogle() {
        auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(res => {
            saveUser(res.user.email);
        });
    }

    function handleLogin() {
        const e = document.getElementById('u-email').value;
        if(e.includes('@')) saveUser(e);
        else alert("Invalid Gmail");
    }

    function saveUser(email) {
        localStorage.setItem('active_user', email);
        location.reload();
    }

    function logout() { localStorage.removeItem('active_user'); location.reload(); }

    // --- DATA SYNC ---
    if(localStorage.getItem('active_user')) {
        document.getElementById('auth-gate').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        document.getElementById('user-display').innerText = "Hello, " + localStorage.getItem('active_user').split('@')[0];
        loadData();
    }

    function loadData() {
        // Wallet Sync
        const userKey = localStorage.getItem('active_user').replace(/[.$#[\]]/g, "_");
        db.ref('wallets/' + userKey).on('value', snap => {
            document.getElementById('balance-txt').innerText = "‚Çπ" + (snap.val() || 0).toLocaleString();
        });

        // Products Sync
        db.ref('shopping').on('value', snap => {
            const grid = document.getElementById('p-grid');
            grid.innerHTML = "";
            snap.forEach(child => {
                const p = child.val();
                grid.innerHTML += `
                    <div class="card">
                        <img src="${p.img}">
                        <div class="card-info">
                            <div class="card-title">${p.title}</div>
                            <div class="card-price">‚Çπ${p.price} <span class="card-mrp">‚Çπ${p.mrp}</span></div>
                            <button class="btn-amz" style="margin-top:10px" onclick="alert('Order Placed!')">Buy Now</button>
                        </div>
                    </div>`;
            });
        });
    }

    function publishItem() {
        const title = document.getElementById('p-name').value;
        const mrp = document.getElementById('p-mrp').value;
        const price = document.getElementById('p-price').value;
        const file = document.getElementById('p-file').files[0];
        const btn = document.getElementById('up-btn');

        if(!file || !title) return alert("Missing Info");
        btn.innerText = "Adding..."; btn.disabled = true;

        const reader = new FileReader();
        reader.onloadend = () => {
            db.ref('shopping').push({ title, mrp, price, img: reader.result }).then(() => {
                alert("Added to Live Store!");
                location.reload();
            });
        };
        reader.readAsDataURL(file);
    }

    // --- NAV & UI ---
    function showSec(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active-sec'));
        document.getElementById(id + '-sec').classList.add('active-sec');
    }

    function toggleAdmin() {
        if(prompt("Admin Access Code:") === "SRP786") showSec('admin');
    }

    function filterItems() {
        let q = document.getElementById('searchInput').value.toLowerCase();
        document.querySelectorAll('.card').forEach(c => {
            c.style.display = c.innerText.toLowerCase().includes(q) ? "" : "none";
        });
    }

    function addMoney() {
        const amt = parseInt(document.getElementById('add-amt').value);
        if(!amt) return;
        const userKey = localStorage.getItem('active_user').replace(/[.$#[\]]/g, "_");
        db.ref('wallets/' + userKey).transaction(curr => (curr || 0) + amt);
        alert("Payment Sync Successful!");
    }
</script>
</body>
</html>
